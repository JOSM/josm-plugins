<project name="ywms" default="build" basedir=".">

	<!-- point to your JOSM directory -->
	<property name="josm" location="../../core/dist/josm-custom.jar" />


	
	<target name="init">
		<mkdir dir="build"/>
	</target>

	<target name="compile" depends="init">
		<javac srcdir="src" classpath="${josm}" destdir="build" debug="true">
			<include name="**/*.java" />
		</javac>
	</target>

	<target name="build" depends="compile">
		<copy todir="build/resources">
			<fileset dir="resources"/>
		</copy>
		<copy todir="build/images">
			<fileset dir="images"/>
		</copy>
		<exec append="false" output="REVISION" executable="svn" failifexecutionfails="false">
			<env key="LANG" value="C"/>
			<arg value="info"/>
			<arg value="--xml"/>
			<arg value="."/>
		</exec>
		<xmlproperty file="REVISION" prefix="version" keepRoot="false" collapseAttributes="true"/>
		<delete file="REVISION"/>
		<jar destfile="ywms.jar" basedir="build">
			<manifest>
				<attribute name="Plugin-Class" value="org.openstreetmap.josm.plugins.ywms.YWMSPlugin"/>
				<attribute name="Plugin-Description" value="A WMS server for Yahoo imagery based on Firefox"/>
				<attribute name="Plugin-Version" value="${version.entry.commit.revision}"/>
				<attribute name="Plugin-Date" value="${version.entry.commit.date}"/>
				<attribute name="Author" value="Francisco R. Santos &lt;frsantos@gmail.com>"/>
			</manifest>
		</jar>
	</target>

	<target name="clean">
		<delete dir="build" />
	</target>

	<target name="install" depends="build">
		<copy file="ywms.jar" todir="${user.home}/.josm/plugins"/>
	</target>

	<target name="test" depends="install">
		<java jar="${josm}" fork="true"/>
	</target>

</project>
