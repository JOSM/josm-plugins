<project name="czechaddress" default="dist" basedir=".">
    <property name="josm.base"              value="../../core"/>
    <property name="josm.jar"               value="${josm.base}/dist/josm-custom.jar"/>
    <property name="josm.doc.dir"           value="${josm.base}/doc"/>
    <property name="plugin.dist.dir"        value="../../dist"/>
    <property name="plugin.build.dir"       value="build"/>
    <property name="plugin.javadoc.dir"     value="doc"/>
    <property name="plugin.basepackage"     value="org.openstreetmap.josm.plugins.czechaddress"/>
    <property name="plugin.basepackage.dir" value="org/openstreetmap/josm/plugins/czechaddress"/>
    <property name="plugin.jar"             value="${plugin.dist.dir}/${ant.project.name}.jar"/>
    <property name="ant.build.javac.target" value="1.5"/>

    <target name="clean">
        <delete dir="${plugin.build.dir}"/> 
        <delete dir="${plugin.jar}"/> 
    </target>
    <target name="init">
        <mkdir dir="${plugin.build.dir}"/>
        <mkdir dir="${plugin.build.dir}"/>
    </target>

    <target name="compile"
            depends="init"
            description="Compile the plugin">
                
        <!-- compile the plugin -->
        <javac srcdir="src"
               sourcepath=""
               classpath="${josm.jar}"
               destdir="${plugin.build.dir}"
               debug="true">

            <include name="**/Status*.java"/>
            <include name="**/StringUtils.java"/>
            <include name="**/NotNull*.java"/>
            <include name="**/addressdatabase/*.java"/>
            <include name="**/proposal*/*.java"/>
            <include name="**/intelligence/Reasoner*.java"/>
            <include name="**/intelligence/Match.java"/>
        </javac>

    </target>


    <!-- Before running "run" target, please "ant dist" the JOSM. -->
    <target name="run" depends="compile">
        <java classname="org.openstreetmap.josm.plugins.czechaddress.intelligence.Reasoner">
            <jvmarg value="-Xmx1024m"/>
            <jvmarg value="-Xdebug"/>
            <jvmarg value="-ea"/>
            <classpath>
                <pathelement location="${plugin.build.dir}"/>
                <pathelement path="${java.class.path}"/>
            </classpath>
            <classpath>
                <pathelement location="${josm.jar}"/>
                <pathelement path="${java.class.path}"/>
            </classpath>
        </java>
        <exec executable="xsltproc" output="log.html">
            <arg value="log.xsl"/>
            <arg value="log.xml"/>
        </exec>
    </target>

</project>
