<project name="lang-de" default="install" basedir=".">

	<property name="language" value="ru" />

	<target name="init">
	    <mkdir dir="bin" />
	</target>

	<target name="compile" depends="init">
		<javac srcdir="src" classpath="../../../core/dist/josm-custom.jar" destdir="bin" />
		<copy file="src/org/openstreetmap/josm/i18n.properties" tofile="bin/org/openstreetmap/josm/i18n.properties" />
	</target>
	
	<!-- install entry point for eclipse user -->
	<target name="jar">
		<jar destfile="${user.home}/.josm/plugins/lang-${language}.jar" basedir="bin">
			<manifest>
				<attribute name="Plugin-Class" value="org.openstreetmap.josm.TranslationLoader_${language}" />
				<attribute name="Plugin-Description" value="Russian Translation" />
				<attribute name="Plugin-Author" value="Translation Team" />
				<attribute name="Plugin-Early" value="true" />
			</manifest>
		</jar>
	</target>
	
	<target name="install" depends="compile,gettext,jar" />



	<target name="find">
		<exec executable="find" output="alljava.txt">
			<arg line="../../../core/src ../.. -name '*.java'"/>
		</exec>
	</target>
	
	<target name="xgettext">
		<exec executable="xgettext">
			<arg line="--from-code=iso-8859-1 -ktr -ktrn:1,2 -ktrc -kmarktr -Ljava -okeys.pot -falljava.txt"/>
		</exec>
	</target>

	<target name="msgmerge">
		<exec executable="msgmerge">
			<arg line="-U ${language}.po keys.pot"/>
		</exec>
	</target>

	<target name="gettext" depends="find,xgettext,msgmerge">
		<exec executable="msgfmt">
			<arg line="--java2 -dbin -rorg.openstreetmap.josm.Translation -l${language} ${language}.po"/>
		</exec>
	</target>

</project>
